{"version":3,"sources":["autoscroll.js"],"names":["define","langx","isBrowser","geom","styler","scrollingElement","dnd","autoScrolls","scrolling","scrollParentEl","IE11OrLess","ie","Edge","edge","Safari","firefox","safari","_throttleTimeout","_getParentAutoScrollElement","el","includeSelf","getBoundingClientRect","elem","gotSelf","clientWidth","scrollWidth","clientHeight","scrollHeight","elemCSS","css","overflowX","overflowY","document","body","parentNode","_autoScroll","_throttle","evt","options","rootEl","isFallback","scroll","_this","expando","window","sens","scrollSensitivity","speed","scrollSpeed","x","clientX","y","clientY","winScroller","scrollThisInstance","_clearAutoScrolls","scrollEl","scrollCustomFn","scrollFn","layersOut","currentParent","vx","vy","canScrollX","canScrollY","scrollPosX","scrollPosY","rect","boundingRect","top","bottom","left","right","width","height","scrollLeft","scrollTop","abs","i","clearInterval","pid","setInterval","this","layer","Sortable","active","_emulateDragOver","_onTouchMove","touchEvt","scrollOffsetY","scrollOffsetX","call","scrollBy","bind","bubbleScroll","forEach","autoScroll","callback","ms","debounce","_isScrolledPast","side","parent","elSide","parentSide","_getRelativeScrollOffset","offsetLeft","offsetTop","matrix","transforms","scaleX","a","scaleY","d","_handleAutoScroll","fallback","elementFromPoint","ogElemScroller","pointerElemChangedInterval","lastPointerElemX","lastPointerElemY","dragEl","newElem","_cancelThrottle","stop"],"mappings":"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","file":"../autoscroll.js","sourcesContent":["define([\r\n\t\"skylark-langx/langx\",\r\n\t\"skylark-langx-hoster/isBrowser\",\r\n\t\"skylark-domx-geom\",\r\n\t\"skylark-domx-styler\",\r\n\t\"skylark-domx-scrolls/scrollingElement\",\r\n\t\"./dnd\"\r\n],function(\r\n\tlangx,\r\n\tisBrowser,\r\n\tgeom,\r\n\tstyler,\r\n\tscrollingElement,\r\n\tdnd\r\n){\r\n\tvar autoScrolls = [],\r\n\t\tscrolling = false,\r\n\t\tscrollParentEl = null;\r\n\r\n\tvar\r\n\t\tIE11OrLess = isBrowser && isBrowser.ie,\r\n\t\tEdge = isBrowser && isBrowser.edge,\r\n\t\tFireFox = isBrowser && isBrowser.firefox,\r\n\t\tSafari = isBrowser && isBrowser.safari;\r\n\r\n\r\n\t/**\r\n\t * Checks if a side of an element is scrolled past a side of it's parents\r\n\t * @param  {HTMLElement}  el       The element who's side being scrolled out of view is in question\r\n\t * @param  {String}       side     Side of the element in question ('top', 'left', 'right', 'bottom')\r\n\t * @return {HTMLElement}           The parent scroll element that the el's side is scrolled past, or null if there is no such element\r\n\t */\r\n\tfunction _isScrolledPast(el, side) {\r\n\t\tvar parent = _getParentAutoScrollElement(el, true),\r\n\t\t\telSide = geom.boundingRect(el)[side];\r\n\r\n\t\t/* jshint boss:true */\r\n\t\twhile (parent) {\r\n\t\t\tvar parentSide = geom.boundingRect(parent)[side],\r\n\t\t\t\tvisible;\r\n\r\n\t\t\tif (side === 'top' || side === 'left') {\r\n\t\t\t\tvisible = elSide >= parentSide;\r\n\t\t\t} else {\r\n\t\t\t\tvisible = elSide <= parentSide;\r\n\t\t\t}\r\n\r\n\t\t\tif (!visible) return parent;\r\n\r\n\t\t\tif (parent === scrollingElement()) break;\r\n\r\n\t\t\tparent = _getParentAutoScrollElement(parent, false);\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the scroll offset of the given element, added with all the scroll offsets of parent elements.\r\n\t * The value is returned in real pixels.\r\n\t * @param  {HTMLElement} el\r\n\t * @return {Array}             Offsets in the format of [left, top]\r\n\t */\r\n\tfunction _getRelativeScrollOffset(el) {\r\n\t\tvar offsetLeft = 0,\r\n\t\t\toffsetTop = 0,\r\n\t\t\twinScroller = scrollingElement();\r\n\r\n\t\tif (el) {\r\n\t\t\tdo {\r\n\t\t\t\tvar matrix = transforms.matrix(el),\r\n\t\t\t\t\tscaleX = matrix.a,\r\n\t\t\t\t\tscaleY = matrix.d;\r\n\r\n\t\t\t\toffsetLeft += el.scrollLeft * scaleX;\r\n\t\t\t\toffsetTop += el.scrollTop * scaleY;\r\n\t\t\t} while (el !== winScroller && (el = el.parentNode));\r\n\t\t}\r\n\r\n\t\treturn [offsetLeft, offsetTop];\r\n\t}\r\n\r\n\tvar _getParentAutoScrollElement = function(el, includeSelf) {\r\n\t\t// skip to window\r\n\t\tif (!el || !el.getBoundingClientRect) return scrollingElement();\r\n\r\n\t\tvar elem = el;\r\n\t\tvar gotSelf = false;\r\n\t\tdo {\r\n\t\t\t// we don't need to get elem css if it isn't even overflowing in the first place (performance)\r\n\t\t\tif (elem.clientWidth < elem.scrollWidth || elem.clientHeight < elem.scrollHeight) {\r\n\t\t\t\tvar elemCSS = styler.css(elem);\r\n\t\t\t\tif (\r\n\t\t\t\t\telem.clientWidth < elem.scrollWidth && (elemCSS.overflowX == 'auto' || elemCSS.overflowX == 'scroll') ||\r\n\t\t\t\t\telem.clientHeight < elem.scrollHeight && (elemCSS.overflowY == 'auto' || elemCSS.overflowY == 'scroll')\r\n\t\t\t\t) {\r\n\t\t\t\t\tif (!elem || !elem.getBoundingClientRect || elem === document.body) return scrollingElement();\r\n\r\n\t\t\t\t\tif (gotSelf || includeSelf) return elem;\r\n\t\t\t\t\tgotSelf = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t/* jshint boss:true */\r\n\t\t} while (elem = elem.parentNode);\r\n\r\n\t\treturn scrollingElement();\r\n\t},\r\n\r\n\r\n\t_autoScroll = _throttle(function (/**Event*/evt, /**Object*/options, /**HTMLElement*/rootEl, /**Boolean*/isFallback) {\r\n\t\t// Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=505521\r\n\t\tif (options.scroll) {\r\n\t\t\tvar _this = rootEl ? rootEl[dnd.expando] : window,\r\n\t\t\t\tsens = options.scrollSensitivity,\r\n\t\t\t\tspeed = options.scrollSpeed,\r\n\r\n\t\t\t\tx = evt.clientX,\r\n\t\t\t\ty = evt.clientY,\r\n\r\n\t\t\t\twinScroller = scrollingElement(),\r\n\r\n\t\t\t\tscrollThisInstance = false;\r\n\r\n\t\t\t// Detect scrollEl\r\n\t\t\tif (scrollParentEl !== rootEl) {\r\n\t\t\t\t_clearAutoScrolls();\r\n\r\n\t\t\t\tscrollEl = options.scroll;\r\n\t\t\t\tscrollCustomFn = options.scrollFn;\r\n\r\n\t\t\t\tif (scrollEl === true) {\r\n\t\t\t\t\tscrollEl = _getParentAutoScrollElement(rootEl, true);\r\n\t\t\t\t\tscrollParentEl = scrollEl;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\t\t\tvar layersOut = 0;\r\n\t\t\tvar currentParent = scrollEl;\r\n\t\t\tdo {\r\n\t\t\t\tvar\tel = currentParent,\r\n\t\t\t\t\trect = geom.boundingRect(el),\r\n\r\n\t\t\t\t\ttop = rect.top,\r\n\t\t\t\t\tbottom = rect.bottom,\r\n\t\t\t\t\tleft = rect.left,\r\n\t\t\t\t\tright = rect.right,\r\n\r\n\t\t\t\t\twidth = rect.width,\r\n\t\t\t\t\theight = rect.height,\r\n\r\n\t\t\t\t\tscrollWidth,\r\n\t\t\t\t\tscrollHeight,\r\n\r\n\t\t\t\t\tcss,\r\n\r\n\t\t\t\t\tvx,\r\n\t\t\t\t\tvy,\r\n\r\n\t\t\t\t\tcanScrollX,\r\n\t\t\t\t\tcanScrollY,\r\n\r\n\t\t\t\t\tscrollPosX,\r\n\t\t\t\t\tscrollPosY;\r\n\r\n\r\n\t\t\t\tscrollWidth = el.scrollWidth;\r\n\t\t\t\tscrollHeight = el.scrollHeight;\r\n\r\n\t\t\t\tcss = styler.css(el);\r\n\r\n\t\t\t\tscrollPosX = el.scrollLeft;\r\n\t\t\t\tscrollPosY = el.scrollTop;\r\n\r\n\t\t\t\tif (el === winScroller) {\r\n\t\t\t\t\tcanScrollX = width < scrollWidth && (css.overflowX === 'auto' || css.overflowX === 'scroll' || css.overflowX === 'visible');\r\n\t\t\t\t\tcanScrollY = height < scrollHeight && (css.overflowY === 'auto' || css.overflowY === 'scroll' || css.overflowY === 'visible');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcanScrollX = width < scrollWidth && (css.overflowX === 'auto' || css.overflowX === 'scroll');\r\n\t\t\t\t\tcanScrollY = height < scrollHeight && (css.overflowY === 'auto' || css.overflowY === 'scroll');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvx = canScrollX && (abs(right - x) <= sens && (scrollPosX + width) < scrollWidth) - (abs(left - x) <= sens && !!scrollPosX);\r\n\r\n\t\t\t\tvy = canScrollY && (abs(bottom - y) <= sens && (scrollPosY + height) < scrollHeight) - (abs(top - y) <= sens && !!scrollPosY);\r\n\r\n\r\n\t\t\t\tif (!autoScrolls[layersOut]) {\r\n\t\t\t\t\tfor (var i = 0; i <= layersOut; i++) {\r\n\t\t\t\t\t\tif (!autoScrolls[i]) {\r\n\t\t\t\t\t\t\tautoScrolls[i] = {};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (autoScrolls[layersOut].vx != vx || autoScrolls[layersOut].vy != vy || autoScrolls[layersOut].el !== el) {\r\n\t\t\t\t\tautoScrolls[layersOut].el = el;\r\n\t\t\t\t\tautoScrolls[layersOut].vx = vx;\r\n\t\t\t\t\tautoScrolls[layersOut].vy = vy;\r\n\r\n\t\t\t\t\tclearInterval(autoScrolls[layersOut].pid);\r\n\r\n\t\t\t\t\tif (el && (vx != 0 || vy != 0)) {\r\n\t\t\t\t\t\tscrollThisInstance = true;\r\n\t\t\t\t\t\t/* jshint loopfunc:true */\r\n\t\t\t\t\t\tautoScrolls[layersOut].pid = setInterval((function () {\r\n\t\t\t\t\t\t\t// emulate drag over during autoscroll (fallback), emulating native DnD behaviour\r\n\t\t\t\t\t\t\tif (isFallback && this.layer === 0) {\r\n\t\t\t\t\t\t\t\tSortable.active._emulateDragOver(true);\r\n\t\t\t\t\t\t\t\tSortable.active._onTouchMove(touchEvt, true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar scrollOffsetY = autoScrolls[this.layer].vy ? autoScrolls[this.layer].vy * speed : 0;\r\n\t\t\t\t\t\t\tvar scrollOffsetX = autoScrolls[this.layer].vx ? autoScrolls[this.layer].vx * speed : 0;\r\n\r\n\t\t\t\t\t\t\tif ('function' === typeof(scrollCustomFn)) {\r\n\t\t\t\t\t\t\t\tif (scrollCustomFn.call(_this, scrollOffsetX, scrollOffsetY, evt, touchEvt, autoScrolls[this.layer].el) !== 'continue') {\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tgeom.scrollBy(autoScrolls[this.layer].el, scrollOffsetX, scrollOffsetY);\r\n\t\t\t\t\t\t}).bind({layer: layersOut}), 24);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tlayersOut++;\r\n\t\t\t} while (options.bubbleScroll && currentParent !== winScroller && (currentParent = _getParentAutoScrollElement(currentParent, false)));\r\n\t\t\tscrolling = scrollThisInstance; // in case another function catches scrolling as false in between when it is not\r\n\t\t}\r\n\t}, 30),\r\n\r\n\t_clearAutoScrolls = function () {\r\n\t\tautoScrolls.forEach(function(autoScroll) {\r\n\t\t\tclearInterval(autoScroll.pid);\r\n\t\t});\r\n\t\tautoScrolls = [];\r\n\t},\r\n\r\n\t_handleAutoScroll = function(evt, options,fallback) {\r\n\t\tvar x = evt.clientX,\r\n\t\t\ty = evt.clientY,\r\n\r\n\t\t\telem = document.elementFromPoint(x, y);\r\n\r\n\t\t// IE does not seem to have native autoscroll,\r\n\t\t// Edge's autoscroll seems too conditional,\r\n\t\t// MACOS Safari does not have autoscroll,\r\n\t\t// Firefox and Chrome are good\r\n\t\tif (fallback || Edge || IE11OrLess || Safari) {\r\n\t\t\t_throttleTimeout = _autoScroll(evt, options, elem, fallback);\r\n\r\n\t\t\t// Listener for pointer element change\r\n\t\t\tvar ogElemScroller = _getParentAutoScrollElement(elem, true);\r\n\t\t\tif (\r\n\t\t\t\tscrolling &&\r\n\t\t\t\t(\r\n\t\t\t\t\t!pointerElemChangedInterval ||\r\n\t\t\t\t\tx !== lastPointerElemX ||\r\n\t\t\t\t\ty !== lastPointerElemY\r\n\t\t\t\t)\r\n\t\t\t) {\r\n\r\n\t\t\t\tpointerElemChangedInterval && clearInterval(pointerElemChangedInterval);\r\n\t\t\t\t// Detect for pointer elem change, emulating native DnD behaviour\r\n\t\t\t\tpointerElemChangedInterval = setInterval(function() {\r\n\t\t\t\t\tif (!dragEl) return;\r\n\t\t\t\t\t// could also check if scroll direction on newElem changes due to parent autoscrolling\r\n\t\t\t\t\tvar newElem = _getParentAutoScrollElement(document.elementFromPoint(x, y), true);\r\n\t\t\t\t\tif (newElem !== ogElemScroller) {\r\n\t\t\t\t\t\togElemScroller = newElem;\r\n\t\t\t\t\t\t_clearAutoScrolls();\r\n\t\t\t\t\t\t_throttleTimeout = _autoScroll(evt, options, ogElemScroller, fallback);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 10);\r\n\t\t\t\tlastPointerElemX = x;\r\n\t\t\t\tlastPointerElemY = y;\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\t// if DnD is enabled (and browser has good autoscrolling), first autoscroll will already scroll, so get parent autoscroll of first autoscroll\r\n\t\t\tif (!options.bubbleScroll || _getParentAutoScrollElement(elem, true) === scrollingElement()) {\r\n\t\t\t\t_clearAutoScrolls();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_throttleTimeout = _autoScroll(evt, options, _getParentAutoScrollElement(elem, false), false);\r\n\t\t}\r\n\t};\r\n\r\n\r\n\tvar _throttleTimeout;\r\n\tfunction _throttle(callback, ms) {\r\n\t\treturn langx.debounce(callback,ms);\r\n\t}\r\n\r\n\tfunction _cancelThrottle() {\r\n\t\t//clearTimeout(_throttleTimeout);\r\n\t\t//_throttleTimeout = void 0;\r\n\t\tif (_throttleTimeout && _throttleTimeout.stop) {\r\n\t\t\t_throttleTimeout.stop();\r\n\t\t\t_throttleTimeout = void 0;\r\n\t\t}\r\n\t}\r\n\r\n\t\r\n\treturn {\r\n\t\tautoScrolls,\r\n\t\t\r\n\t\t_isScrolledPast,\r\n\t\t_getRelativeScrollOffset,\r\n\t\t_autoScroll,\r\n\r\n\t\t_clearAutoScrolls,\r\n\t\t_handleAutoScroll,\r\n\r\n\t\t_throttle,\r\n\t\t_cancelThrottle\r\n\t}\r\n});"]}