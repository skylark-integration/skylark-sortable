{"version":3,"sources":["autoscroll.js"],"names":["define","langx","isBrowser","geom","styler","scrollingElement","scrollEl","scrollCustomFn","pointerElemChangedInterval","autoScrolls","scrolling","scrollParentEl","IE11OrLess","ie","Edge","edge","Safari","firefox","safari","_throttleTimeout","_getParentAutoScrollElement","el","includeSelf","getBoundingClientRect","elem","gotSelf","clientWidth","scrollWidth","clientHeight","scrollHeight","elemCSS","css","overflowX","overflowY","document","body","parentNode","_autoScroll","_throttle","evt","options","rootEl","isFallback","expando","scroll","_this","window","sens","scrollSensitivity","speed","scrollSpeed","x","clientX","y","clientY","winScroller","scrollThisInstance","_clearAutoScrolls","scrollFn","layersOut","currentParent","vx","vy","canScrollX","canScrollY","scrollPosX","scrollPosY","rect","boundingRect","top","bottom","left","right","width","height","scrollLeft","scrollTop","Math","abs","i","clearInterval","pid","setInterval","this","layer","Sortable","active","_emulateDragOver","_onTouchMove","touchEvt","scrollOffsetY","scrollOffsetX","call","scrollBy","bind","bubbleScroll","forEach","autoScroll","callback","ms","debounce","_isScrolledPast","side","parent","elSide","parentSide","_getRelativeScrollOffset","offsetLeft","offsetTop","matrix","transforms","scaleX","a","scaleY","d","_handleAutoScroll","fallback","elementFromPoint","ogElemScroller","lastPointerElemX","lastPointerElemY","dragEl","newElem","_cancelThrottle","stop","_nulling"],"mappings":"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","file":"../autoscroll.js","sourcesContent":["define([\r\n\t\"skylark-langx/langx\",\r\n\t\"skylark-langx-hoster/isBrowser\",\r\n\t\"skylark-domx-geom\",\r\n\t\"skylark-domx-styler\",\r\n\t\"skylark-domx-scrolls/scrollingElement\"\r\n],function(\r\n\tlangx,\r\n\tisBrowser,\r\n\tgeom,\r\n\tstyler,\r\n\tscrollingElement\r\n){\r\n    'use strict';\r\n\r\n\tvar autoScrolls = [],\r\n\t\tscrolling = false,\r\n\t\tscrollEl,\r\n\t\tscrollCustomFn,\r\n\t\tpointerElemChangedInterval,\r\n\r\n\t\tscrollParentEl = null;\r\n\r\n\tvar\r\n\t\tIE11OrLess = isBrowser && isBrowser.ie,\r\n\t\tEdge = isBrowser && isBrowser.edge,\r\n\t\tFireFox = isBrowser && isBrowser.firefox,\r\n\t\tSafari = isBrowser && isBrowser.safari;\r\n\r\n\r\n\t/**\r\n\t * Checks if a side of an element is scrolled past a side of it's parents\r\n\t * @param  {HTMLElement}  el       The element who's side being scrolled out of view is in question\r\n\t * @param  {String}       side     Side of the element in question ('top', 'left', 'right', 'bottom')\r\n\t * @return {HTMLElement}           The parent scroll element that the el's side is scrolled past, or null if there is no such element\r\n\t */\r\n\tfunction _isScrolledPast(el, side) {\r\n\t\tvar parent = _getParentAutoScrollElement(el, true),\r\n\t\t\telSide = geom.boundingRect(el)[side];\r\n\r\n\t\t/* jshint boss:true */\r\n\t\twhile (parent) {\r\n\t\t\tvar parentSide = geom.boundingRect(parent)[side],\r\n\t\t\t\tvisible;\r\n\r\n\t\t\tif (side === 'top' || side === 'left') {\r\n\t\t\t\tvisible = elSide >= parentSide;\r\n\t\t\t} else {\r\n\t\t\t\tvisible = elSide <= parentSide;\r\n\t\t\t}\r\n\r\n\t\t\tif (!visible) return parent;\r\n\r\n\t\t\tif (parent === scrollingElement()) break;\r\n\r\n\t\t\tparent = _getParentAutoScrollElement(parent, false);\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the scroll offset of the given element, added with all the scroll offsets of parent elements.\r\n\t * The value is returned in real pixels.\r\n\t * @param  {HTMLElement} el\r\n\t * @return {Array}             Offsets in the format of [left, top]\r\n\t */\r\n\tfunction _getRelativeScrollOffset(el) {\r\n\t\tvar offsetLeft = 0,\r\n\t\t\toffsetTop = 0,\r\n\t\t\twinScroller = scrollingElement();\r\n\r\n\t\tif (el) {\r\n\t\t\tdo {\r\n\t\t\t\tvar matrix = transforms.matrix(el),\r\n\t\t\t\t\tscaleX = matrix.a,\r\n\t\t\t\t\tscaleY = matrix.d;\r\n\r\n\t\t\t\toffsetLeft += el.scrollLeft * scaleX;\r\n\t\t\t\toffsetTop += el.scrollTop * scaleY;\r\n\t\t\t} while (el !== winScroller && (el = el.parentNode));\r\n\t\t}\r\n\r\n\t\treturn [offsetLeft, offsetTop];\r\n\t}\r\n\r\n\tvar _getParentAutoScrollElement = function(el, includeSelf) {\r\n\t\t// skip to window\r\n\t\tif (!el || !el.getBoundingClientRect) return scrollingElement();\r\n\r\n\t\tvar elem = el;\r\n\t\tvar gotSelf = false;\r\n\t\tdo {\r\n\t\t\t// we don't need to get elem css if it isn't even overflowing in the first place (performance)\r\n\t\t\tif (elem.clientWidth < elem.scrollWidth || elem.clientHeight < elem.scrollHeight) {\r\n\t\t\t\tvar elemCSS = styler.css(elem);\r\n\t\t\t\tif (\r\n\t\t\t\t\telem.clientWidth < elem.scrollWidth && (elemCSS.overflowX == 'auto' || elemCSS.overflowX == 'scroll') ||\r\n\t\t\t\t\telem.clientHeight < elem.scrollHeight && (elemCSS.overflowY == 'auto' || elemCSS.overflowY == 'scroll')\r\n\t\t\t\t) {\r\n\t\t\t\t\tif (!elem || !elem.getBoundingClientRect || elem === document.body) return scrollingElement();\r\n\r\n\t\t\t\t\tif (gotSelf || includeSelf) return elem;\r\n\t\t\t\t\tgotSelf = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t/* jshint boss:true */\r\n\t\t} while (elem = elem.parentNode);\r\n\r\n\t\treturn scrollingElement();\r\n\t},\r\n\r\n\r\n\t_autoScroll = _throttle(function (/**Event*/evt, /**Object*/options, /**HTMLElement*/rootEl, /**Boolean*/isFallback,expando) {\r\n\t\t// Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=505521\r\n\t\tif (options.scroll) {\r\n\t\t\tvar _this = rootEl ? rootEl[expando] : window,\r\n\t\t\t\tsens = options.scrollSensitivity,\r\n\t\t\t\tspeed = options.scrollSpeed,\r\n\r\n\t\t\t\tx = evt.clientX,\r\n\t\t\t\ty = evt.clientY,\r\n\r\n\t\t\t\twinScroller = scrollingElement(),\r\n\r\n\t\t\t\tscrollThisInstance = false;\r\n\r\n\t\t\t// Detect scrollEl\r\n\t\t\tif (scrollParentEl !== rootEl) {\r\n\t\t\t\t_clearAutoScrolls();\r\n\r\n\t\t\t\tscrollEl = options.scroll;\r\n\t\t\t\tscrollCustomFn = options.scrollFn;\r\n\r\n\t\t\t\tif (scrollEl === true) {\r\n\t\t\t\t\tscrollEl = _getParentAutoScrollElement(rootEl, true);\r\n\t\t\t\t\tscrollParentEl = scrollEl;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\t\t\tvar layersOut = 0;\r\n\t\t\tvar currentParent = scrollEl;\r\n\t\t\tdo {\r\n\t\t\t\tvar\tel = currentParent,\r\n\t\t\t\t\trect = geom.boundingRect(el),\r\n\r\n\t\t\t\t\ttop = rect.top,\r\n\t\t\t\t\tbottom = rect.bottom,\r\n\t\t\t\t\tleft = rect.left,\r\n\t\t\t\t\tright = rect.right,\r\n\r\n\t\t\t\t\twidth = rect.width,\r\n\t\t\t\t\theight = rect.height,\r\n\r\n\t\t\t\t\tscrollWidth,\r\n\t\t\t\t\tscrollHeight,\r\n\r\n\t\t\t\t\tcss,\r\n\r\n\t\t\t\t\tvx,\r\n\t\t\t\t\tvy,\r\n\r\n\t\t\t\t\tcanScrollX,\r\n\t\t\t\t\tcanScrollY,\r\n\r\n\t\t\t\t\tscrollPosX,\r\n\t\t\t\t\tscrollPosY;\r\n\r\n\r\n\t\t\t\tscrollWidth = el.scrollWidth;\r\n\t\t\t\tscrollHeight = el.scrollHeight;\r\n\r\n\t\t\t\tcss = styler.css(el);\r\n\r\n\t\t\t\tscrollPosX = el.scrollLeft;\r\n\t\t\t\tscrollPosY = el.scrollTop;\r\n\r\n\t\t\t\tif (el === winScroller) {\r\n\t\t\t\t\tcanScrollX = width < scrollWidth && (css.overflowX === 'auto' || css.overflowX === 'scroll' || css.overflowX === 'visible');\r\n\t\t\t\t\tcanScrollY = height < scrollHeight && (css.overflowY === 'auto' || css.overflowY === 'scroll' || css.overflowY === 'visible');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcanScrollX = width < scrollWidth && (css.overflowX === 'auto' || css.overflowX === 'scroll');\r\n\t\t\t\t\tcanScrollY = height < scrollHeight && (css.overflowY === 'auto' || css.overflowY === 'scroll');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvx = canScrollX && (Math.abs(right - x) <= sens && (scrollPosX + width) < scrollWidth) - (Math.abs(left - x) <= sens && !!scrollPosX);\r\n\r\n\t\t\t\tvy = canScrollY && (Math.abs(bottom - y) <= sens && (scrollPosY + height) < scrollHeight) - (Math.abs(top - y) <= sens && !!scrollPosY);\r\n\r\n\r\n\t\t\t\tif (!autoScrolls[layersOut]) {\r\n\t\t\t\t\tfor (var i = 0; i <= layersOut; i++) {\r\n\t\t\t\t\t\tif (!autoScrolls[i]) {\r\n\t\t\t\t\t\t\tautoScrolls[i] = {};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (autoScrolls[layersOut].vx != vx || autoScrolls[layersOut].vy != vy || autoScrolls[layersOut].el !== el) {\r\n\t\t\t\t\tautoScrolls[layersOut].el = el;\r\n\t\t\t\t\tautoScrolls[layersOut].vx = vx;\r\n\t\t\t\t\tautoScrolls[layersOut].vy = vy;\r\n\r\n\t\t\t\t\tclearInterval(autoScrolls[layersOut].pid);\r\n\r\n\t\t\t\t\tif (el && (vx != 0 || vy != 0)) {\r\n\t\t\t\t\t\tscrollThisInstance = true;\r\n\t\t\t\t\t\t/* jshint loopfunc:true */\r\n\t\t\t\t\t\tautoScrolls[layersOut].pid = setInterval((function () {\r\n\t\t\t\t\t\t\t// emulate drag over during autoscroll (fallback), emulating native DnD behaviour\r\n\t\t\t\t\t\t\tif (isFallback && this.layer === 0) {\r\n\t\t\t\t\t\t\t\tSortable.active._emulateDragOver(true);\r\n\t\t\t\t\t\t\t\tSortable.active._onTouchMove(touchEvt, true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar scrollOffsetY = autoScrolls[this.layer].vy ? autoScrolls[this.layer].vy * speed : 0;\r\n\t\t\t\t\t\t\tvar scrollOffsetX = autoScrolls[this.layer].vx ? autoScrolls[this.layer].vx * speed : 0;\r\n\r\n\t\t\t\t\t\t\tif ('function' === typeof(scrollCustomFn)) {\r\n\t\t\t\t\t\t\t\tif (scrollCustomFn.call(_this, scrollOffsetX, scrollOffsetY, evt, touchEvt, autoScrolls[this.layer].el) !== 'continue') {\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tgeom.scrollBy(autoScrolls[this.layer].el, scrollOffsetX, scrollOffsetY);\r\n\t\t\t\t\t\t}).bind({layer: layersOut}), 24);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tlayersOut++;\r\n\t\t\t} while (options.bubbleScroll && currentParent !== winScroller && (currentParent = _getParentAutoScrollElement(currentParent, false)));\r\n\t\t\tscrolling = scrollThisInstance; // in case another function catches scrolling as false in between when it is not\r\n\t\t}\r\n\t}, 30),\r\n\r\n\t_clearAutoScrolls = function () {\r\n\t\tautoScrolls.forEach(function(autoScroll) {\r\n\t\t\tclearInterval(autoScroll.pid);\r\n\t\t});\r\n\t\tautoScrolls = [];\r\n\t},\r\n\r\n\t_handleAutoScroll = function(evt, options,fallback) {\r\n\t\tvar x = evt.clientX,\r\n\t\t\ty = evt.clientY,\r\n\r\n\t\t\telem = document.elementFromPoint(x, y);\r\n\r\n\t\t// IE does not seem to have native autoscroll,\r\n\t\t// Edge's autoscroll seems too conditional,\r\n\t\t// MACOS Safari does not have autoscroll,\r\n\t\t// Firefox and Chrome are good\r\n\t\tif (fallback || Edge || IE11OrLess || Safari) {\r\n\t\t\t_throttleTimeout = _autoScroll(evt, options, elem, fallback);\r\n\r\n\t\t\t// Listener for pointer element change\r\n\t\t\tvar ogElemScroller = _getParentAutoScrollElement(elem, true);\r\n\t\t\tif (\r\n\t\t\t\tscrolling &&\r\n\t\t\t\t(\r\n\t\t\t\t\t!pointerElemChangedInterval ||\r\n\t\t\t\t\tx !== lastPointerElemX ||\r\n\t\t\t\t\ty !== lastPointerElemY\r\n\t\t\t\t)\r\n\t\t\t) {\r\n\r\n\t\t\t\tpointerElemChangedInterval && clearInterval(pointerElemChangedInterval);\r\n\t\t\t\t// Detect for pointer elem change, emulating native DnD behaviour\r\n\t\t\t\tpointerElemChangedInterval = setInterval(function() {\r\n\t\t\t\t\tif (!dragEl) return;\r\n\t\t\t\t\t// could also check if scroll direction on newElem changes due to parent autoscrolling\r\n\t\t\t\t\tvar newElem = _getParentAutoScrollElement(document.elementFromPoint(x, y), true);\r\n\t\t\t\t\tif (newElem !== ogElemScroller) {\r\n\t\t\t\t\t\togElemScroller = newElem;\r\n\t\t\t\t\t\t_clearAutoScrolls();\r\n\t\t\t\t\t\t_throttleTimeout = _autoScroll(evt, options, ogElemScroller, fallback);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 10);\r\n\t\t\t\tlastPointerElemX = x;\r\n\t\t\t\tlastPointerElemY = y;\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\t// if DnD is enabled (and browser has good autoscrolling), first autoscroll will already scroll, so get parent autoscroll of first autoscroll\r\n\t\t\tif (!options.bubbleScroll || _getParentAutoScrollElement(elem, true) === scrollingElement()) {\r\n\t\t\t\t_clearAutoScrolls();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_throttleTimeout = _autoScroll(evt, options, _getParentAutoScrollElement(elem, false), false);\r\n\t\t}\r\n\t};\r\n\r\n\r\n\tvar _throttleTimeout;\r\n\tfunction _throttle(callback, ms) {\r\n\t\treturn langx.debounce(callback,ms);\r\n\t}\r\n\r\n\tfunction _cancelThrottle() {\r\n\t\t//clearTimeout(_throttleTimeout);\r\n\t\t//_throttleTimeout = void 0;\r\n\t\tif (_throttleTimeout && _throttleTimeout.stop) {\r\n\t\t\t_throttleTimeout.stop();\r\n\t\t\t_throttleTimeout = void 0;\r\n\t\t}\r\n\t}\r\n\r\n\t\r\n\tfunction _nulling() {\r\n\t\tpointerElemChangedInterval && clearInterval(pointerElemChangedInterval);\r\n\t\tpointerElemChangedInterval = null;\r\n\r\n\t}\r\n\treturn {\r\n\t\tautoScrolls,\r\n\t\t\r\n\t\t_isScrolledPast,\r\n\t\t_getRelativeScrollOffset,\r\n\t\t_autoScroll,\r\n\r\n\t\t_clearAutoScrolls,\r\n\t\t_handleAutoScroll,\r\n\r\n\t\t_throttle,\r\n\t\t_cancelThrottle,\r\n\t\t_nulling\r\n\t}\r\n});"]}