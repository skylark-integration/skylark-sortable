/**
 * skylark-sortable - A version of sortable.js that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-sortable/
 * @license MIT
 */
define(["skylark-langx/langx","skylark-langx-hoster/isBrowser","skylark-domx-geom","skylark-domx-styler","skylark-domx-scrolls/scrollingElement"],function(l,e,o,r,t){var n=[],i=!1,a=e&&e.ie,c=e&&e.edge,s=(e&&e.firefox,e&&e.safari);var v,f=function(l,e){if(!l||!l.getBoundingClientRect)return t();var o=l,n=!1;do{if(o.clientWidth<o.scrollWidth||o.clientHeight<o.scrollHeight){var i=r.css(o);if(o.clientWidth<o.scrollWidth&&("auto"==i.overflowX||"scroll"==i.overflowX)||o.clientHeight<o.scrollHeight&&("auto"==i.overflowY||"scroll"==i.overflowY)){if(!o||!o.getBoundingClientRect||o===document.body)return t();if(n||e)return o;n=!0}}}while(o=o.parentNode);return t()},u=h(function(l,e,a,c){if(e.scroll){var s=a?a[expando]:window,v=e.scrollSensitivity,u=e.scrollSpeed,h=l.clientX,g=l.clientY,m=t(),b=!1;scrollParentEl!==a&&(d(),scrollEl=e.scroll,scrollCustomFn=e.scrollFn,!0===scrollEl&&(scrollEl=f(a,!0),scrollParentEl=scrollEl));var y=0,w=scrollEl;do{var E,p,x,S,k,X,Y,C,I,P=w,_=o.boundingRect(P),F=_.top,R=_.bottom,H=_.left,W=_.right,B=_.width,T=_.height;if(E=P.scrollWidth,p=P.scrollHeight,x=r.css(P),C=P.scrollLeft,I=P.scrollTop,P===m?(X=B<E&&("auto"===x.overflowX||"scroll"===x.overflowX||"visible"===x.overflowX),Y=T<p&&("auto"===x.overflowY||"scroll"===x.overflowY||"visible"===x.overflowY)):(X=B<E&&("auto"===x.overflowX||"scroll"===x.overflowX),Y=T<p&&("auto"===x.overflowY||"scroll"===x.overflowY)),S=X&&(abs(W-h)<=v&&C+B<E)-(abs(H-h)<=v&&!!C),k=Y&&(abs(R-g)<=v&&I+T<p)-(abs(F-g)<=v&&!!I),!n[y])for(var A=0;A<=y;A++)n[A]||(n[A]={});n[y].vx==S&&n[y].vy==k&&n[y].el===P||(n[y].el=P,n[y].vx=S,n[y].vy=k,clearInterval(n[y].pid),!P||0==S&&0==k||(b=!0,n[y].pid=setInterval(function(){c&&0===this.layer&&(Sortable.active._emulateDragOver(!0),Sortable.active._onTouchMove(touchEvt,!0));var e=n[this.layer].vy?n[this.layer].vy*u:0,r=n[this.layer].vx?n[this.layer].vx*u:0;"function"==typeof scrollCustomFn&&"continue"!==scrollCustomFn.call(s,r,e,l,touchEvt,n[this.layer].el)||o.scrollBy(n[this.layer].el,r,e)}.bind({layer:y}),24))),y++}while(e.bubbleScroll&&w!==m&&(w=f(w,!1)));i=b}},30),d=function(){n.forEach(function(l){clearInterval(l.pid)}),n=[]};function h(e,o){return l.debounce(e,o)}return{autoScrolls:n,_isScrolledPast:function(l,e){for(var r=f(l,!0),n=o.boundingRect(l)[e];r;){var i=o.boundingRect(r)[e];if(!("top"===e||"left"===e?n>=i:n<=i))return r;if(r===t())break;r=f(r,!1)}return!1},_getRelativeScrollOffset:function(l){var e=0,o=0,r=t();if(l)do{var n=transforms.matrix(l),i=n.a,a=n.d;e+=l.scrollLeft*i,o+=l.scrollTop*a}while(l!==r&&(l=l.parentNode));return[e,o]},_autoScroll:u,_clearAutoScrolls:d,_handleAutoScroll:function(l,e,o){var r=l.clientX,n=l.clientY,h=document.elementFromPoint(r,n);if(o||c||a||s){v=u(l,e,h,o);var g=f(h,!0);!i||pointerElemChangedInterval&&r===lastPointerElemX&&n===lastPointerElemY||(pointerElemChangedInterval&&clearInterval(pointerElemChangedInterval),pointerElemChangedInterval=setInterval(function(){if(dragEl){var t=f(document.elementFromPoint(r,n),!0);t!==g&&(g=t,d(),v=u(l,e,g,o))}},10),lastPointerElemX=r,lastPointerElemY=n)}else{if(!e.bubbleScroll||f(h,!0)===t())return void d();v=u(l,e,f(h,!1),!1)}},_throttle:h,_cancelThrottle:function(){v&&v.stop&&(v.stop(),v=void 0)}}});
//# sourceMappingURL=sourcemaps/autoscroll.js.map
