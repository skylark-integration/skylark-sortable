/**
 * skylark-sortable - A version of sortable.js that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-sortable/
 * @license MIT
 */
define(["skylark-langx/langx","skylark-langx-hoster/isBrowser","skylark-domx-geom","skylark-domx-styler","skylark-domx-plugins-scrolls/scrolling-element"],function(l,o,e,r,t){"use strict";var n,i,c,a,s,u=[],f=!1,v=null,d=o&&o.ie,h=o&&o.edge,g=(o&&o.firefox,o&&o.safari);var w,y=function(l,o){if(!l||!l.getBoundingClientRect)return t();var e=l,n=!1;do{if(e.clientWidth<e.scrollWidth||e.clientHeight<e.scrollHeight){var i=r.css(e);if(e.clientWidth<e.scrollWidth&&("auto"==i.overflowX||"scroll"==i.overflowX)||e.clientHeight<e.scrollHeight&&("auto"==i.overflowY||"scroll"==i.overflowY)){if(!e||!e.getBoundingClientRect||e===document.body)return t();if(n||o)return e;n=!0}}}while(e=e.parentNode);return t()},b=p(function(l,o,c,a,s){if(o.scroll){var d=c?c[s]:window,h=o.scrollSensitivity,g=o.scrollSpeed,w=l.clientX,b=l.clientY,p=t(),x=!1;v!==c&&(m(),n=o.scroll,i=o.scrollFn,!0===n&&(n=y(c,!0),v=n));var k=0,S=n;do{var X,Y,_,I,R,H,W,B,E,M=S,P=e.boundingRect(M),F=P.top,T=P.bottom,A=P.left,C=P.right,L=P.width,N=P.height;if(X=M.scrollWidth,Y=M.scrollHeight,_=r.css(M),B=M.scrollLeft,E=M.scrollTop,M===p?(H=L<X&&("auto"===_.overflowX||"scroll"===_.overflowX||"visible"===_.overflowX),W=N<Y&&("auto"===_.overflowY||"scroll"===_.overflowY||"visible"===_.overflowY)):(H=L<X&&("auto"===_.overflowX||"scroll"===_.overflowX),W=N<Y&&("auto"===_.overflowY||"scroll"===_.overflowY)),I=H&&(Math.abs(C-w)<=h&&B+L<X)-(Math.abs(A-w)<=h&&!!B),R=W&&(Math.abs(T-b)<=h&&E+N<Y)-(Math.abs(F-b)<=h&&!!E),!u[k])for(var O=0;O<=k;O++)u[O]||(u[O]={});u[k].vx==I&&u[k].vy==R&&u[k].el===M||(u[k].el=M,u[k].vx=I,u[k].vy=R,clearInterval(u[k].pid),!M||0==I&&0==R||(x=!0,u[k].pid=setInterval(function(){var o=u[this.layer].vy?u[this.layer].vy*g:0,r=u[this.layer].vx?u[this.layer].vx*g:0;"function"==typeof i&&"continue"!==i.call(d,r,o,l,touchEvt,u[this.layer].el)||e.scrollBy(u[this.layer].el,r,o)}.bind({layer:k}),24))),k++}while(o.bubbleScroll&&S!==p&&(S=y(S,!1)));f=x}},30),m=function(){u.forEach(function(l){clearInterval(l.pid)}),u=[]};function p(o,e){return l.debounce(o,e)}return{autoScrolls:u,_isScrolledPast:function(l,o){for(var r=y(l,!0),n=e.boundingRect(l)[o];r;){var i=e.boundingRect(r)[o];if(!("top"===o||"left"===o?n>=i:n<=i))return r;if(r===t())break;r=y(r,!1)}return!1},_getRelativeScrollOffset:function(l){var o=0,e=0,r=t();if(l)do{var n=transforms.matrix(l),i=n.a,c=n.d;o+=l.scrollLeft*i,e+=l.scrollTop*c}while(l!==r&&(l=l.parentNode));return[o,e]},_autoScroll:b,_clearAutoScrolls:m,_handleAutoScroll:function(l,o,e,r){var n=l.clientX,i=l.clientY,u=document.elementFromPoint(n,i);if(e||h||d||g){w=b(l,o,u,e,r);var v=y(u,!0);!f||c&&n===a&&i===s||(c&&clearInterval(c),c=setInterval(function(){var r=y(document.elementFromPoint(n,i),!0);r!==v&&(v=r,m(),w=b(l,o,v,e))},10),a=n,s=i)}else{if(!o.bubbleScroll||y(u,!0)===t())return void m();w=b(l,o,y(u,!1),!1)}},_throttle:p,_cancelThrottle:function(){w&&w.stop&&(w.stop(),w=void 0)},_nulling:function(){c&&clearInterval(c),c=null,a=null,s=null,this.scrollEl=this.scrollParentEl=this.autoScrolls.length=null}}});
//# sourceMappingURL=../sourcemaps/fallback/autoscroll.js.map
